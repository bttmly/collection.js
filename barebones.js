// Generated by CoffeeScript 1.7.1
(function() {
  "use strict";
  var __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  (function(root, factory) {
    var _;
    if (typeof define === "function" && define.amd) {
      define(["underscore", "exports"], function(_, exports) {
        root.Barebones = factory(root, exports, _);
      });
    } else if (typeof exports !== "undefined") {
      _ = require("lodash") || require("underscore");
      factory(root, exports, _);
    } else {
      root.Barebones = factory(root, {}, root._);
    }
  })(this, function(root, Barebones, _) {
    var Collection, attributeMethods, collectionMethods, lib, nativeMethods, returnsCollectionMethods;
    lib = _.noop ? "lodash" : "underscore";
    Collection = (function(_super) {
      __extends(Collection, _super);

      function Collection(models) {
        var model, _i, _len;
        if (models) {
          for (_i = 0, _len = models.length; _i < _len; _i++) {
            model = models[_i];
            this.push(model);
          }
        }
      }

      return Collection;

    })(Array);
    collectionMethods = ['forEach', 'each', 'map', 'collect', 'reduce', 'foldl', 'inject', 'reduceRight', 'foldr', 'find', 'detect', 'filter', 'select', 'reject', 'every', 'all', 'some', 'any', 'include', 'contains', 'invoke', 'max', 'min', 'toArray', 'size', 'first', 'head', 'take', 'initial', 'rest', 'tail', 'drop', 'last', 'without', 'indexOf', 'shuffle', 'lastIndexOf', 'isEmpty', 'chain'];
    collectionMethods = collectionMethods.concat('pluck', 'where', 'findWhere');
    if (lib === "lodash") {
      collectionMethods = collectionMethods.concat('at', 'eachRight', 'forEachRight', 'findLast');
    }
    _.each(collectionMethods, function(method) {
      Collection.prototype[method] = function() {
        var args;
        args = [].slice.call(arguments);
        args.unshift(this);
        return _[method].apply(_, args);
      };
    });
    attributeMethods = ['groupBy', 'countBy', 'sortBy', 'indexBy'];
    _.each(attributeMethods, function(method) {
      Collection.prototype[method] = function(value, context) {
        var iterator;
        iterator = _.isFunction(value) ? value : function(model) {
          return model[value];
        };
        return _[method](this, iterator, context);
      };
    });
    nativeMethods = ['slice', 'splice', 'shift', 'pop', 'join', 'reverse', 'sort'];
    _.each(nativeMethods, function(method) {
      Collection.prototype[method] = function() {
        var args;
        args = [].slice.call(arguments);
        args.unshift(this);
        return [][method].apply(this, arguments);
      };
    });
    returnsCollectionMethods = ['filter', 'select', 'where', 'reject'];
    _.each(returnsCollectionMethods, function(method) {
      var methodName;
      methodName = "col" + method.charAt(0).toUpperCase() + method.slice(1);
      Collection.prototype[methodName] = function() {
        var args, collection, constructor;
        constructor = Object.getPrototypeOf(this).constructor;
        args = [].slice.call(arguments);
        args.unshift(this);
        collection = _[method].apply(_, args);
        return new constructor(collection);
      };
    });
    return Collection;
  });

}).call(this);
